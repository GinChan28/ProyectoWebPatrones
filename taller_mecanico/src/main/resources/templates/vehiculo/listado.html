<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <head th:replace="general/fragmentos :: head('Mis Vehículos')"></head>
    <body>
        <div th:replace="general/fragmentos :: header"></div>

        <div class="container py-5">
            <div class="mb-4">
                <h2 class="fw-bold d-flex align-items-center gap-2">
                    <i class="bi bi-car-front-fill text-primary fs-3"></i> Vehículos
                </h2>
                <p class="text-muted">Consulta y gestiona los vehículos que tenemos para ti.</p>
            </div>

            <div class="card border-0 shadow-sm rounded-3">
                <div class="card-body">

                    <div th:if="${exito}" class="alert alert-success alert-dismissible fade show" role="alert">
                        <i class="bi bi-check-circle-fill me-2"></i>
                        <span th:text="${exito}"></span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                    </div>

                    <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <span th:text="${error}"></span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                    </div>

                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <a th:href="@{/vehiculo/nuevo}" class="btn btn-primary btn-sm" data-bs-toggle="tooltip" title="Registrar nuevo vehículo">
                            <i class="bi bi-plus-circle me-1"></i> Nuevo Vehículo
                        </a>
                        <span class="text-muted small">
                            Última actualización:
                            <span th:text="${#dates.format(#dates.createNow(), 'dd/MM/yyyy HH:mm')}">04/11/2025 15:22</span>
                        </span>
                    </div>

                    <div th:if="${#lists.isEmpty(vehiculos)}" class="text-center py-4">
                        <i class="bi bi-info-circle text-secondary fs-4"></i>
                        <p class="mt-2 text-muted">No tienes vehículos registrados aún.</p>
                    </div>

                    <div th:unless="${#lists.isEmpty(vehiculos)}" class="table-responsive">
                        <table class="table table-hover table-bordered table-sm align-middle mb-0">
                            <thead class="table-light text-center">
                                <tr>
                                    <th>Placa</th>
                                    <th>Marca</th>
                                    <th>Modelo</th>
                                    <th>Año</th>
                                    <th class="text-center">Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="v : ${vehiculos}">
                                    <td th:text="${v.placa}">ABC123</td>
                                    <td th:text="${v.marca}">Toyota</td>
                                    <td th:text="${v.modelo}">Corolla</td>
                                    <td th:text="${v.anno}">2018</td>
                                    <td class="text-center">
                                        <a th:href="@{'/vehiculo/editar/' + ${v.idVehiculo}}"
                                           class="btn btn-outline-secondary btn-sm me-1" data-bs-toggle="tooltip" title="Editar">
                                            <i class="bi bi-pencil-square"></i>
                                        </a>

                                        <!-- Botón eliminar con confirmación -->
                                        <form th:action="@{'/vehiculo/eliminar/' + ${v.idVehiculo}}"
                                              method="post" class="d-inline"
                                              onsubmit="return confirm('¿Estás seguro de eliminar este vehículo?');">
                                            <button type="submit" class="btn btn-outline-danger btn-sm" data-bs-toggle="tooltip" title="Eliminar">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </form>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>

        <div th:replace="general/fragmentos :: footer"></div>

        <!-- Bootstrap Icons CDN -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <!-- Tooltip activation -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                tooltipTriggerList.forEach(function (tooltipTriggerEl) {
                    new bootstrap.Tooltip(tooltipTriggerEl);
                });
            });
        </script>
    </body>
</html>