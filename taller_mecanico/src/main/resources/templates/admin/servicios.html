<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Servicios</title>

    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.7/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/webjars/font-awesome/7.0.0/css/all.min.css}">

    <style>
        body {
            background: #eef3fb;
        }

        .card-servicio {
            border-radius: 20px;
            border: none;
            box-shadow: 0 6px 18px rgba(0,0,0,.1);
            transition: .25s;
        }

        .card-servicio:hover {
            transform: translateY(-5px);
        }

        .badge-estado {
            font-size: .8rem;
        }
    </style>
</head>
<body>

<!-- NAVBAR ADMIN -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">

        <a class="navbar-brand fw-bold" th:href="@{/admin/dashboard}">
            Taller Mecánico | Admin
        </a>

        <div class="d-flex align-items-center gap-2">

            <a th:href="@{/admin/dashboard}" class="btn btn-outline-light btn-sm">
                <i class="fa-solid fa-arrow-left"></i>
                Dashboard
            </a>

            <div sec:authorize="isAuthenticated()">
                <form th:action="@{/logout}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-light btn-sm fw-semibold">
                        <i class="fa-solid fa-right-from-bracket"></i>
                        Cerrar sesión
                    </button>
                </form>
            </div>

        </div>
    </div>
</nav>

<!-- CONTENIDO -->
<div class="container py-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0">Gestión de Servicios</h2>

        <a th:href="@{/admin/servicios/nuevo}" class="btn btn-primary">
            <i class="fa-solid fa-plus"></i>
            Nuevo Servicio
        </a>
    </div>

    <div class="row g-4">

        <div class="col-md-4" th:each="s : ${servicios}">
            <div class="card card-servicio p-4 h-100">

                <h5 class="fw-bold mb-1" th:text="${s.nombre}"></h5>

                <p class="text-muted small mb-2"
                   th:text="${s.descripcion}">
                </p>

                <p class="fw-semibold mb-2">
                    ₡
                    <span th:text="${#numbers.formatDecimal(s.precioBase,1,2)}"></span>
                </p>

                <span class="badge badge-estado"
                      th:classappend="${s.activo} ? 'bg-success' : 'bg-secondary'"
                      th:text="${s.activo ? 'Activo' : 'Inactivo'}">
                </span>

                <div class="d-flex justify-content-between mt-4">

                    <a th:href="@{/admin/servicios/editar/{id}(id=${s.idServicio})}"
                       class="btn btn-outline-primary btn-sm">
                        <i class="fa-solid fa-pen"></i>
                        Editar
                    </a>

                    <a th:href="@{/admin/servicios/eliminar/{id}(id=${s.idServicio})}"
                       class="btn btn-outline-danger btn-sm"
                       onclick="return confirm('¿Eliminar este servicio?');">
                        <i class="fa-solid fa-trash"></i>
                        Eliminar
                    </a>

                </div>

            </div>
        </div>

        <!-- VACÍO -->
        <div class="col-12 text-center text-muted"
             th:if="${#lists.isEmpty(servicios)}">
            No hay servicios registrados
        </div>

    </div>

</div>

</body>
</html>
